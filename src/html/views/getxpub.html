<div class="row">
    <label>Coin:</label>
    <select id="coin">
        <option>Bitcoin</option>
        <option>Bitcoin Cash</option>
        <option>Litecoin</option>
        <option>Dash</option>
        <option>Zcash</option>
        <option selected>Testnet</option>
    </select>
</div>

<div class="row">
    <label class="custom-checkbox">
        Let me pick account
        <input type="checkbox" id="discovery" />
    </label>
</div>

<div class="row">
    <label class="custom-checkbox">
        Confirmation
        <input type="checkbox" id="confirmation" checked />
    </label>
</div>

<div class="row">
    <label>Path</label>
    <input type="text" id="path" class="small" value="m/49'/0'/0'" />
</div>


<div class="row">
    <label></label>
    <button id="getPublicKey-path">Get public key using path</button>
</div>

<div class="row">
    <label>Account</label>
    <select id="account">
        <option>Account #1</option>
        <option>Account #2</option>
        <option>Account #3</option>
        <option>Account #4</option>
        <option>Account #5</option>
        <option>Account #6</option>
        <option>Account #7</option>
        <option>Account #8</option>
        <option>Account #9</option>
        <option>Account #10</option>
    </select>
</div>

<div class="row">
    <label class="custom-checkbox">
        Legacy account
        <input type="checkbox" id="legacy" />
    </label>
</div>

<div class="row">
    <label></label>
    <button id="getPublicKey-id">Get public key account ID</button>
</div>



<script type="text/javascript">

    var defaultPaths = {
        "Bitcoin":       "m/49'/0'/0'",
        "Bitcoin Cash":  "m/44'/145'/0'",
        "Litecoin":      "m/49'/2'/0'",
        "Dogecoin":      "m/44'/3'/0'",
        "Dash":          "m/44'/5'/0'",
        "Zcash":         "m/44'/133'/0'",
        "Testnet":       "m/49'/1'/0'",
        "Namecoin":      "m/44'/7'/0'",
    }
    var pathButton = document.getElementById('getPublicKey-path');
    pathButton.onclick = onButtonClick;

    var accountButton = document.getElementById('getPublicKey-id');
    accountButton.onclick = onButtonClick;

    var coinSelect = document.getElementById('coin');
    var accountSelect = document.getElementById('account');
    var pathInput = document.getElementById('path');
    var discoveryCheckbox = document.getElementById('discovery');
    var confirmationCheckbox = document.getElementById('confirmation');
    var legacyCheckbox = document.getElementById('legacy');
    pathInput.value = defaultPaths[coinSelect.value];

    discoveryCheckbox.onchange = function() {
        pathInput.disabled =
        accountSelect.disabled =
        pathButton.disabled =
        confirmationCheckbox.disabled =
        legacyCheckbox.disabled = discoveryCheckbox.checked;
        accountButton.innerHTML = discoveryCheckbox.checked ? 'Get public key using discovery' : 'Get public key using account id';
    }

    coinSelect.onchange = function() {
        pathInput.value = defaultPaths[coinSelect.value];
        legacyCheckbox.disabled = (pathInput.value.indexOf('49') < 0);
    }

    function onButtonClick(event){
        var path = pathInput.value;
        var coin = coinSelect.value;
        var discovery = discoveryCheckbox.checked;
        var confirmation = confirmationCheckbox.checked;

        var params = {
            selectedDevice: window.selectedDevice
        };

        if (!discovery) {
            if (event.currentTarget.id === 'getPublicKey-path') {
                params.path = path;
            } else {
                params.account = accountSelect.selectedIndex;
                if (!legacyCheckbox.disabled && legacyCheckbox.checked)
                    params.accountLegacy = legacyCheckbox.checked;
            }
            if (!confirmation)
                params.confirmation = confirmation;
        }
        params.coin = coin;

        TrezorConnect.getPublicKey(params).then(handleResponse);

        // TrezorConnect.getPublicKey({
        //     //selectedDevice: _selectedDevice,

        //     account: 0,
        //     //accountLegacy: true,

        //     //path: "m/48'/0'/0'",
        //     //path: [44, 2, 20],
        //     //path: [48, 0, 0], // multisig
        //     //path: [45342, 44, 0, 0], // CopayId legacy
        //     //path: [45342, 49, 0, 0], // CopayId segwit
        //     //path: [45342, 48, 0, 0], // CopayId multisig
        //     //path: [44 | 0x80000000, 1 | 0x80000000, 4 | 0x80000000 ],

        //     //confirmation: false,

        //     coin: coin,
        //     //coin: 'ltc'
        // })
        // .then(handleResponse);
    }
</script>

<pre style="display: none;">
TrezorConnect.composeTransaction({
    outputs: [
        {
            address: address,
            amount: amount,
        },
    ],
    coin: coin,
    //push: true
})
</pre>

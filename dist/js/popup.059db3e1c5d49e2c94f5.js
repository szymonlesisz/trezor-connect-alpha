!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Trezor",[],t):"object"==typeof exports?exports.Trezor=t():e.Trezor=t()}(this,function(){return function(e){function t(a){if(n[a])return n[a].exports;var i=n[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,a){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="./",t(t.s=454)}({10:function(e,t,n){"use strict";t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},38:function(e,t,n){"use strict";t.__esModule=!0,t.ErrorMessage=t.ResponseMessage=t.DeviceMessage=t.UiMessage=t.parseMessage=t.ERROR_EVENT=t.RESPONSE_EVENT=t.DEVICE_EVENT=t.UI_EVENT=void 0;var a=n(10),i=function(e){return e&&e.__esModule?e:{default:e}}(a),r=t.UI_EVENT="UI_EVENT",o=t.DEVICE_EVENT="DEVICE_EVENT",s=t.RESPONSE_EVENT="RESPONSE_EVENT",c=t.ERROR_EVENT="ERROR_EVENT";t.parseMessage=function(e){return{event:e.event,type:e.type,id:e.id,success:e.success,data:e.data,error:e.error,args:e.args,level:e.level}},t.UiMessage=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;(0,i.default)(this,e),this.event=r,this.type=t,this.data=n},t.DeviceMessage=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;(0,i.default)(this,e),this.event=o,this.type=t,this.data=n},t.ResponseMessage=function e(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;(0,i.default)(this,e),this.event=s,this.type=s,this.id=t,this.success=n,this.data=a},t.ErrorMessage=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(0,i.default)(this,e),this.event=c,this.type=c,this.error=t}},454:function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var i,r=n(51),o=n(38),s=n(70),c=a(s),l=n(50),u=a(l),E=n(455),d=(function(e){e&&e.__esModule}(E),function(e){if(e.origin===window.opener.location.origin){console.log("handleMessage",e.data);var t=(0,o.parseMessage)(e.data);switch(t.type){case u.LOADING:f(t.data);break;case u.TRANSPORT:p("transport");break;case u.CONNECT:p("connect");break;case u.SELECT_DEVICE:N(t.data);break;case u.SELECT_ACCOUNT:w(t.data);break;case u.BOOTLOADER:p("bootloader");break;case u.INITIALIZE:p("initialize");break;case u.FIRMWARE:p("firmware");break;case u.REQUEST_PERMISSION:C(t.data,e.origin);break;case u.REQUEST_CONFIRMATION:T(t.data);break;case u.REQUEST_PIN:I();break;case u.INVALID_PIN:p("invalid_pin");break;case u.REQUEST_PASSPHRASE:b()}}}),f=function(e){var t=p("loader");if("string"==typeof e){var n=t.getElementsByTagName("p")[0];n.style.display="block",n.innerHTML=e}},p=function(e){_();var t=document.getElementById("views"),n=document.getElementById("container"),a=t.getElementsByClassName(e);if(a)n.innerHTML=a.item(0).outerHTML;else{var i=t.getElementsByClassName("unknown-view");n.innerHTML=i.item(0).outerHTML}return n},_=function(){document.getElementById("container").innerHTML="",window.removeEventListener("keydown",m,!1),window.removeEventListener("keydown",g,!1)},g=function(e){13===e.keyCode&&(e.preventDefault(),h())},m=function(e){switch(e.preventDefault(),e.keyCode){case 13:h();break;case 8:y();break;case 49:case 97:v(1);break;case 50:case 98:v(2);break;case 51:case 99:v(3);break;case 52:case 100:v(4);break;case 53:case 101:v(5);break;case 54:case 102:v(6);break;case 55:case 103:v(7);break;case 56:case 104:v(8);break;case 57:case 105:v(9)}},v=function(e){var t=document.getElementById("container"),n=t.getElementsByClassName("input")[0];n.value.length<9&&(n.value+=e)},y=function(){var e=document.getElementById("container"),t=e.getElementsByClassName("input")[0],n=t.value;t.value=n.substring(0,n.length-1)},h=function(){document.getElementById("container").getElementsByClassName("submit")[0].click()},I=function(){p("pin");var e=document.getElementById("container"),t=e.getElementsByClassName("input")[0],n=e.getElementsByClassName("submit")[0],a=e.getElementsByClassName("pin_backspace")[0],i=e.querySelectorAll("[data-value]"),r=void 0,s=i.length,c=function(e){if(e.target instanceof HTMLElement){var n=e.target.getAttribute("data-value");n&&(t.value+=n)}p("loader")};for(r=0;r<s;r++)i.item(r).addEventListener("click",c);a.addEventListener("click",y),n.addEventListener("click",function(e){p("loader"),M(new o.UiMessage(u.RECEIVE_PIN,t.value))}),window.addEventListener("keydown",m,!1)},b=function(){p("passphrase");var e=document.getElementById("container"),t=e.getElementsByClassName("input")[0],n=e.getElementsByClassName("passphrase_checkbox")[0],a=e.getElementsByClassName("submit")[0];n.addEventListener("click",function(){t.type="text"===t.type?"password":"text",t.focus()}),a.addEventListener("click",function(){p("loader"),M(new o.UiMessage(u.RECEIVE_PASSPHRASE,t.value))}),window.addEventListener("keydown",g,!1),t.focus()},N=function(e){if(e){if(0===e.length)return void p("connect");p("select_device");for(var t=document.getElementById("container"),n=t.getElementsByClassName("select_device_list")[0],a=function(e){e.target instanceof HTMLElement&&M(new o.UiMessage(u.RECEIVE_DEVICE,e.target.getAttribute("data-path"))),p("loader")},i=e,r=Array.isArray(i),s=0,i=r?i:i[Symbol.iterator]();;){var c;if(r){if(s>=i.length)break;c=i[s++]}else{if(s=i.next(),s.done)break;c=s.value}var l=c,E=document.createElement("button");E.innerHTML=l.label,E.onclick=a,E.setAttribute("data-path",l.path),n.appendChild(E)}}},C=function(e,t){p("permissions");var n=document.getElementById("container"),a=n.getElementsByTagName("h3")[0],i=a.getElementsByTagName("span")[0],r=n.getElementsByClassName("permissions_list")[0],s=n.getElementsByClassName("confirm_button")[0],c=n.getElementsByClassName("cancel_button")[0];if(i.innerHTML=t,console.warn("ORIGIN",t),e&&Array.isArray(e)){var l=document.createElement("ul");l.className="permissions_list";for(var E=e,d=Array.isArray(E),f=0,E=d?E:E[Symbol.iterator]();;){var _;if(d){if(f>=E.length)break;_=E[f++]}else{if(f=E.next(),f.done)break;_=f.value}var g=_,m=document.createElement("li");m.innerHTML=g,l.append(m)}r.append(l)}s.onclick=function(){M(new o.UiMessage(u.RECEIVE_PERMISSION,"true")),p("loader")},c.onclick=function(){M(new o.UiMessage(u.RECEIVE_PERMISSION,"false")),p("loader")}},T=function(e){p(e.view);var t=document.getElementById("container"),n=t.getElementsByTagName("h3")[0],a=t.getElementsByClassName("confirm_button")[0],i=t.getElementsByClassName("cancel_button")[0];n.innerHTML="Export xpub for "+e.label,a.onclick=function(){M(new o.UiMessage(u.RECEIVE_CONFIRMATION,"true")),p("loader")},i.onclick=function(){M(new o.UiMessage(u.RECEIVE_CONFIRMATION,"false")),p("loader")}},w=function(e){if(e){if(0===e.length)return void f("Loading accounts...");p("select_account");for(var t=document.getElementById("container"),n=t.getElementsByClassName("select_account_list")[0],a=function(e){e.target instanceof HTMLElement&&M(new o.UiMessage(u.RECEIVE_ACCOUNT,e.target.getAttribute("data-account"))),p("loader")},i=e,r=Array.isArray(i),s=0,i=r?i:i[Symbol.iterator]();;){var c;if(r){if(s>=i.length)break;c=i[s++]}else{if(s=i.next(),s.done)break;c=s.value}var l=c,E=document.createElement("button");E.innerHTML=l.label,E.onclick=a,E.setAttribute("data-account",l.id),n.appendChild(E)}}},M=function(e){window.opener&&i&&(i?i.postMessage(e,"*"):window.opener.postMessage({type:"error",message:"Popup couldn't establish connection with iframe."},"*"))};window.addEventListener("load",function(){for(var e=window.opener.frames,t=0;t<e.length;t++)try{e[t].location.host===window.location.host&&(i=e[t])}catch(e){}window.addEventListener("message",d),M(new o.UiMessage(c.HANDSHAKE)),(0,r.popupConsole)(c.LOG,M),window.closeWindow=function(){window.close()}},!1)},455:function(e,t){},50:function(e,t,n){"use strict";t.__esModule=!0;t.TRANSPORT="ui_no_transport",t.BOOTLOADER="ui_bootloader",t.INITIALIZE="ui_initialize",t.FIRMWARE="ui_firmware",t.REQUEST_UI_WINDOW="ui_request_window",t.CLOSE_UI_WINDOW="ui_close_window",t.REQUEST_PERMISSION="ui_request_permission",t.REQUEST_CONFIRMATION="ui_request_confirmation",t.REQUEST_PIN="ui_request_pin",t.INVALID_PIN="ui_invalid_pin",t.REQUEST_PASSPHRASE="ui_request_passphrase",t.CONNECT="ui_connect",t.LOADING="ui_loading",t.SELECT_DEVICE="ui_select_device",t.SELECT_ACCOUNT="ui_select_account",t.SELECT_FEE="ui_select_fee",t.RECEIVE_PERMISSION="ui_receive_permission",t.RECEIVE_CONFIRMATION="ui_receive_confirmation",t.RECEIVE_PIN="ui_receive_pin",t.RECEIVE_PASSPHRASE="ui_receive_passphrase",t.RECEIVE_DEVICE="ui_receive_device",t.RECEIVE_ACCOUNT="ui_receive_account",t.RECEIVE_FEE="ui_receive_fee",t.CHANGE_SETTINGS="ui_change_settings"},51:function(e,t,n){"use strict";(function(e){t.__esModule=!0,t.popupConsole=t.enableByPrefix=t.enable=t.init=void 0;var a=n(10),i=function(e){return e&&e.__esModule?e:{default:e}}(a),r={},o=(t.init=function(e){var t=new s(e,!0);return r[e]=t,t},t.enable=function(e){for(var t=Object.keys(r),n=Array.isArray(t),a=0,t=n?t:t[Symbol.iterator]();;){var i;if(n){if(a>=t.length)break;i=t[a++]}else{if(a=t.next(),a.done)break;i=a.value}r[i].enabled=e}},t.enableByPrefix=function(e,t){r[e]&&(r[e].enabled=t)},{DescriptorStream:"color: #77ab59",DeviceList:"color: #36802d",Device:"color: #bada55",Channel:"color: #c9df8a",IFrame:"color: #f4a742",Popup:"color: #f48a00"}),s=function(){function e(t,n){(0,i.default)(this,e),this.prefix=t,this.enabled=n,this.messages=[],this.css=o[t]||"color: #000000"}return e.prototype.addMessage=function(e,t){for(var n=arguments.length,a=Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i];this.messages.push({level:e,prefix:t,message:a,timestamp:(new Date).getTime()})},e.prototype.log=function(){for(var e,t=arguments.length,n=Array(t),a=0;a<t;a++)n[a]=arguments[a];this.addMessage.apply(this,["log",this.prefix].concat(n)),this.enabled&&(e=console).log.apply(e,[this.prefix].concat(n))},e.prototype.error=function(){for(var e,t=arguments.length,n=Array(t),a=0;a<t;a++)n[a]=arguments[a];this.addMessage.apply(this,["error",this.prefix].concat(n)),this.enabled&&(e=console).error.apply(e,[this.prefix].concat(n))},e.prototype.warn=function(){for(var e,t=arguments.length,n=Array(t),a=0;a<t;a++)n[a]=arguments[a];this.addMessage.apply(this,["warn",this.prefix].concat(n)),this.enabled&&(e=console).warn.apply(e,[this.prefix].concat(n))},e.prototype.debug=function(){for(var e,t=arguments.length,n=Array(t),a=0;a<t;a++)n[a]=arguments[a];this.addMessage.apply(this,["debug",this.prefix].concat(n)),this.enabled&&(e=console).log.apply(e,["%c"+this.prefix,this.css].concat(n))},e}();t.default=s;t.popupConsole=function(t,n){var a=e.console,i={error:a.error,info:a.info,debug:a.debug,log:a.log},r=[];for(var o in i)a[o]=function(e,i){return function(){for(var o=arguments.length,s=Array(o),c=0;c<o;c++)s[c]=arguments[c];var l=(new Date).toUTCString();return r.push([i,l].concat(s)),n.apply(void 0,[{type:t,level:i,time:l,args:JSON.stringify(s)}]),e.apply(a,s)}}(i[o],o)}}).call(t,n(7))},7:function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},70:function(e,t,n){"use strict";t.__esModule=!0;t.LOG="popup_log",t.OPENED="popup_opened",t.OPEN_TIMEOUT="popup_open_timeout",t.HANDSHAKE="popup_handshake",t.CLOSE="popup_close",t.CLOSED="popup_closed",t.CANCEL_POPUP_REQUEST="ui_cancel_popup_request"}})});